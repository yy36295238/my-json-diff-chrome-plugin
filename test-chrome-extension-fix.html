<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromeæ‰©å±•ä¿®å¤æµ‹è¯•</title>
    <link rel="stylesheet" href="chrome-extension/popup-styles.css">
    <style>
        body {
            margin: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-header {
            background: #f5f5f5;
            padding: 10px 15px;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
        }
        .test-note {
            background: #e3f2fd;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            border-left: 4px solid #2196f3;
        }
        .test-controls {
            margin: 15px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        .test-btn {
            margin: 5px;
            padding: 8px 12px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .test-btn:hover {
            background: #1976d2;
        }
    </style>
</head>
<body>
    <div class="test-note">
        <h3>Chromeæ‰©å±•ä¿®å¤æµ‹è¯•</h3>
        <p><strong>æµ‹è¯•å†…å®¹ï¼š</strong></p>
        <ol>
            <li>JSONæ ¼å¼åŒ–é¢„è§ˆçš„æŠ˜å /å±•å¼€åŠŸèƒ½</li>
            <li>æ’¤é”€/é‡åšå†å²è®°å½•åŠŸèƒ½</li>
            <li>å¿«æ·é”®æ”¯æŒ (Ctrl+Z, Ctrl+Y, Ctrl+Shift+F)</li>
        </ol>
        <p><strong>æµ‹è¯•JSONæ•°æ®ï¼š</strong></p>
        <pre>{"name":"æµ‹è¯•ç”¨æˆ·","details":{"age":25,"hobbies":["è¯»ä¹¦","æ¸¸æˆ"],"address":{"city":"åŒ—äº¬","district":"æœé˜³åŒº"}}}</pre>
    </div>

    <div class="test-controls">
        <button class="test-btn" onclick="fillTestData()">å¡«å…¥æµ‹è¯•æ•°æ®</button>
        <button class="test-btn" onclick="testFormat()">æµ‹è¯•æ ¼å¼åŒ–</button>
        <button class="test-btn" onclick="testUndo()">æµ‹è¯•æ’¤é”€</button>
        <button class="test-btn" onclick="testRedo()">æµ‹è¯•é‡åš</button>
        <button class="test-btn" onclick="testCollapse()">æµ‹è¯•æŠ˜å </button>
    </div>

    <div class="test-container">
        <div class="test-header">Chromeæ‰©å±•æ¨¡æ‹Ÿç•Œé¢</div>
        <div class="popup-container">
            <!-- å¤´éƒ¨ -->
            <header class="popup-header">
                <div class="logo">
                    <span class="logo-icon">ğŸ”§</span>
                    <h1>JSONå·¥å…·</h1>
                </div>
                <button class="theme-toggle" id="themeToggle" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</button>
            </header>

            <!-- æ ‡ç­¾å¯¼èˆª -->
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="formatter">æ ¼å¼åŒ–</button>
                <button class="tab-btn" data-tab="compare">å¯¹æ¯”</button>
                <button class="tab-btn" data-tab="generator">ç”Ÿæˆå™¨</button>
            </nav>

            <!-- æ ¼å¼åŒ–é¡µé¢ -->
            <div class="tab-content active" id="formatter-content">
                <div class="input-section">
                    <textarea id="jsonInput" placeholder="è¾“å…¥JSONæ•°æ®..." rows="8"></textarea>
                    <div class="action-row">
                        <button class="btn primary" id="formatBtn">ç¾åŒ–</button>
                        <button class="btn secondary" id="compressBtn">å‹ç¼©</button>
                        <button class="btn secondary" id="validateBtn">éªŒè¯</button>
                    </div>
                </div>
                <div class="output-section">
                    <div class="output-header">
                        <span>è¾“å‡ºç»“æœ</span>
                        <button class="btn-small" id="copyResult">å¤åˆ¶</button>
                        <button class="btn-small" id="undoBtn">æ’¤é”€</button>
                        <button class="btn-small" id="redoBtn">é‡åš</button>
                    </div>
                    <div id="jsonOutput" class="json-output"></div>
                </div>
            </div>

            <!-- å¯¹æ¯”é¡µé¢ -->
            <div class="tab-content" id="compare-content">
                <div class="compare-inputs">
                    <div class="input-group">
                        <label>JSON 1</label>
                        <textarea id="json1" placeholder="ç¬¬ä¸€ä¸ªJSON..." rows="4"></textarea>
                    </div>
                    <div class="input-group">
                        <label>JSON 2</label>
                        <textarea id="json2" placeholder="ç¬¬äºŒä¸ªJSON..." rows="4"></textarea>
                    </div>
                </div>
                <div class="action-row">
                    <button class="btn primary" id="compareBtn">å¯¹æ¯”</button>
                    <button class="btn secondary" id="swapBtn">äº¤æ¢</button>
                </div>
                <div class="compare-result" id="compareResult"></div>
            </div>

            <!-- ç”Ÿæˆå™¨é¡µé¢ -->
            <div class="tab-content" id="generator-content">
                <div class="generator-options">
                    <div class="input-group">
                        <label>æ¨¡æ¿ç±»å‹</label>
                        <select id="templateSelect">
                            <option value="user">ç”¨æˆ·ä¿¡æ¯</option>
                            <option value="product">å•†å“æ•°æ®</option>
                            <option value="order">è®¢å•è®°å½•</option>
                        </select>
                    </div>
                    <div class="input-row">
                        <div class="input-group small">
                            <label>æ•°é‡</label>
                            <input type="number" id="generateCount" value="1" min="1" max="100">
                        </div>
                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" id="generateArray"> ç”Ÿæˆæ•°ç»„
                            </label>
                        </div>
                    </div>
                </div>
                <div class="action-row">
                    <button class="btn primary" id="generateBtn">ç”Ÿæˆæ•°æ®</button>
                    <button class="btn secondary" id="useGeneratedBtn">ä½¿ç”¨æ•°æ®</button>
                </div>
                <div class="generated-output">
                    <textarea id="generatedOutput" placeholder="ç”Ÿæˆçš„æ•°æ®å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." rows="6" readonly></textarea>
                </div>
            </div>

            <!-- çŠ¶æ€æ  -->
            <div class="status-bar">
                <span id="statusText">å°±ç»ª</span>
                <div class="quick-actions">
                    <button class="btn-icon" id="settingsBtn" title="è®¾ç½®">âš™ï¸</button>
                    <button class="btn-icon" id="openFullBtn" title="æ‰“å¼€å®Œæ•´ç‰ˆ">ğŸ”—</button>
                </div>
            </div>
        </div>
    </div>

    <script src="chrome-extension/popup.js"></script>
    <script>
        // æµ‹è¯•åŠŸèƒ½
        function fillTestData() {
            const testData = '{"name":"æµ‹è¯•ç”¨æˆ·","details":{"age":25,"hobbies":["è¯»ä¹¦","æ¸¸æˆ"],"address":{"city":"åŒ—äº¬","district":"æœé˜³åŒº"}}}';
            document.getElementById('jsonInput').value = testData;
            if (window.jsonTool) {
                window.jsonTool.realTimeValidation(testData);
            }
        }

        function testFormat() {
            if (window.jsonTool) {
                window.jsonTool.formatJSON();
                console.log('æ ¼å¼åŒ–æµ‹è¯•å®Œæˆï¼Œæ£€æŸ¥é¢„è§ˆåŒºåŸŸæ˜¯å¦æ˜¾ç¤ºæ ‘å½¢ç»“æ„');
            }
        }

        function testUndo() {
            if (window.jsonTool) {
                window.jsonTool.undo();
                console.log('æ’¤é”€æµ‹è¯•å®Œæˆï¼Œæ£€æŸ¥æ˜¯å¦æ¢å¤åˆ°ä¸Šä¸€ä¸ªçŠ¶æ€');
            }
        }

        function testRedo() {
            if (window.jsonTool) {
                window.jsonTool.redo();
                console.log('é‡åšæµ‹è¯•å®Œæˆï¼Œæ£€æŸ¥æ˜¯å¦å‰è¿›åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€');
            }
        }

        function testCollapse() {
            // æŸ¥æ‰¾æ‰€æœ‰æŠ˜å æŒ‰é’®å¹¶æµ‹è¯•
            const collapseButtons = document.querySelectorAll('.json-collapsible');
            if (collapseButtons.length > 0) {
                collapseButtons.forEach((btn, index) => {
                    console.log(`æµ‹è¯•æŠ˜å æŒ‰é’® ${index + 1}`);
                    btn.click();
                });
                console.log('æŠ˜å æµ‹è¯•å®Œæˆï¼Œæ£€æŸ¥å†…å®¹æ˜¯å¦æ­£ç¡®æŠ˜å /å±•å¼€');
            } else {
                console.log('æ²¡æœ‰æ‰¾åˆ°æŠ˜å æŒ‰é’®ï¼Œè¯·å…ˆæ ¼å¼åŒ–JSONæ•°æ®');
            }
        }

        // æ·»åŠ é”®ç›˜äº‹ä»¶æµ‹è¯•æç¤º
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'z' && !e.shiftKey) {
                console.log('æ£€æµ‹åˆ°æ’¤é”€å¿«æ·é”®: Ctrl/Cmd+Z');
            }
            if ((e.ctrlKey || e.metaKey) && e.key === 'y') {
                console.log('æ£€æµ‹åˆ°é‡åšå¿«æ·é”®: Ctrl/Cmd+Y');
            }
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'F') {
                console.log('æ£€æµ‹åˆ°æ ¼å¼åŒ–å¿«æ·é”®: Ctrl/Cmd+Shift+F');
            }
        });

        console.log('Chromeæ‰©å±•ä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½');
        console.log('ä½¿ç”¨F12æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹æµ‹è¯•æ—¥å¿—');
    </script>
</body>
</html>